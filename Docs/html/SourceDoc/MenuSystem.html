<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="index,nofollow">


<title>SourceDoc/MenuSystem - Freevo 2.0 Wiki</title>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin-1.3.1/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="/moin-1.3.1/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="/moin-1.3.1/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" href="/moin-1.3.1/modern/css/freevo.css">

<link rel="alternate" title="Freevo 2.0 Wiki Recent Changes" href="/cgi-bin/freevo-2.0/RecentChanges?action=rss_rc&amp;ddiffs=1&amp;unique=1" type="application/rss+xml">
<link rel="Start" href="/cgi-bin/freevo-2.0/Index">
<link rel="Alternate" title="Wiki Markup" href="/cgi-bin/freevo-2.0/SourceDoc/MenuSystem?action=raw">
<link rel="Alternate" media="print" title="Print View" href="/cgi-bin/freevo-2.0/SourceDoc/MenuSystem?action=print">
<link rel="Up" href="/cgi-bin/freevo-2.0/SourceDoc">
<link rel="Search" href="/cgi-bin/freevo-2.0/FindPage">
<link rel="Index" href="/cgi-bin/freevo-2.0/TitleIndex">
<link rel="Glossary" href="/cgi-bin/freevo-2.0/WordIndex">
<link rel="Help" href="/cgi-bin/freevo-2.0/HelpOnFormatting">
</head>

<body  lang="en" dir="ltr">

            <!-- Header Logo and Status Line -->
<div id="titlebar"><span class="name"><a href="http://freevo.sourceforge.net/" target="_blank">Freevo</a></span></div>
<div id="header">
<ul>

	<li><a href="../Index.html">User Documentation</a></li>
	<li id="current"><a href="../SourceDoc.html">Source Documenation</a></li>
        
</ul>
</div>
<p>&nbsp;</p>
<div id="page" lang="en" dir="ltr"><!-- start page -->


<h1 id="title">SourceDoc/MenuSystem</h1>
<div lang="en" id="content" dir="ltr">
<a id="top"></a>
<ol>

<li>
<a href="#head-5456630128205ca9c5cffda39b968f830e6c3b1c">Menu</a>
</li>

<li>
<a href="#head-745663ded2204e23999cba5c295081d54eb62ff7">Item</a>
</li>

<li>
<a href="#head-e171ce35ecb580c146c909812d4fc011e486d23c">MenuItem</a>
</li>

<li>
<a href="#head-6b5342fa4ca3fa43b25c4b5bbe2d443ae179757b">MenuWidget</a>
</li>

<li>
<a href="#head-40dd9f480765c6bc3166db16cedd43b94a0f2bcc">Example</a>
</li>

</ol>
<p> </p>
<p>Menu's in freevo are done using the classes described below. But in general they are essential lists of items which have their names displayed in the list. Each item then has actions associated with them. The first action is the one used when selected and you can use enter to see the others. Menu's also have actions that can be associated with them to perform actions or updates. </p>
<p>PleaseUpdate: The following doc is copied from the "Plugin Writing Howto" and needs to be checked if the information is still valid. Maybe also create simpler examples with more documentation. </p>

<h2 id="head-5456630128205ca9c5cffda39b968f830e6c3b1c">Menu</h2>

<p>Menu is essentially a class wrapped around an array of choices. It has several methods but the constructor is the most commonly used. It takes a title, then an array of options, and then some optional parameters. The reload_func is the most commonly used. The reload_func is used when you come back from executing an item. It's only used when you want to show something other than the menu you started with when you come back. 
</p>
<pre>
# make the command menu using the command_items array and when we
# call refresh with the reload arg we go back to the main menu.
command_menu = menu.Menu(_('Commands'), command_items,
                  reload_func=menuwidget.goto_main_menu)

# make a basic menu with the string variable name for its name and
# items the array of choices.
mymenu = menu.Menu(name, items)
</pre>

<h2 id="head-745663ded2204e23999cba5c295081d54eb62ff7">Item</h2>

<p>Item is the base class for anything that appears in the Menu. Generally you create a subclass of Item and then create an actions method to tell the menu what to do when the item is clicked. The name property is what the Menu object uses to display on the screen. You can then create other variables to hold important data points in. 
</p>
<pre>
class CoolItem(Item):
    def __init__(self, command):
        Item.__init__(self)
        self.name = command
        self.image = util.getimage(self.cmd)

    def actions(self):
        """
        return a list of actions for this item
        """
        items = [ ( self.runMyCommand , _('Run Command') ) ]
        return items

    def runMyCommand(self, arg=None, menuw=None):
        # do some real cool stuff..
</pre>

<h2 id="head-e171ce35ecb580c146c909812d4fc011e486d23c">MenuItem</h2>

<p>This is a convenience class it is useful in two different situations. The first and most common is for creating Menus to display error conditions. The second use is for when you only need a very simple item with a single easy action. </p>
<p>To use MenuItem in the error condition case you call the constructor with three parameters. The first parameter is what to display in the menu, the second is the action to take  when the item to select and the third is put the arg to the action function. In this case you typically wrap the constructor call into an append to your list of items to be given to menu. </p>
<p>To use MenuItem as a simple Item and not bother with creating your own sub item class, you again call the constructor with the set of three parameters.  The first parameter is what to display in the menu, the second is the action to take  when the item to select and the third is put the arg to the action function. But typically you save a reference to this item and set a few additional parameters manually. 
</p>
<pre>
# you would then create a menu like normal and then push it onto the stack
command_items += [menu.MenuItem(_('No Commands found'),
                         menuwidget.goto_prev_page, 0)]

# generic item use for things that are simple
# you would then create a menu like normal and then push it onto the stack
if item.info.has_key('audio'):
    items.append(menu.MenuItem(_('Audio selection'),
                         audio_selection_menu, item))
if item.info.has_key('subtitles'):
    items.append(menu.MenuItem(_('Subtitle selection'),
                         subtitle_selection_menu, item))
if item.info.has_key('chapters'):
    items.append(menu.MenuItem(_('Chapter selection'),
                         chapter_selection_menu, item))
</pre>

<h2 id="head-6b5342fa4ca3fa43b25c4b5bbe2d443ae179757b">MenuWidget</h2>

<p>MenuWidget or menuw as it is often labelled in the code. Is a handy utility class where most of the menu magic happens. It has most of the default utility actions for menus as well as the methods to manage the menu stack. </p>
<p>Common Menu Actions: </p>
<ul>
<li><p> back_one_menu: goes to the previous menu. Typically used after deleteing the current menu. see cdbackup.py for an example. </p>
</li>
<li><p> goto_main_menu: jumps all the way back to the main menu. </p>
</li>
</ul>
<p>List of menu stack actions: </p>
<ul>
<li><p> pushmenu: used after constructing a menu, then typically a call to refresh to display the menu. </p>
</li>
<li><p> refresh: redraw the top item on the menu stack. It is usually called after a pushmenu call. </p>
</li>
<li><p> delete_menu: remove the currently displayed menu. </p>
</li>
</ul>
<p>PleaseUpdate: add more functions. </p>

<h2 id="head-40dd9f480765c6bc3166db16cedd43b94a0f2bcc">Example</h2>

<p>This is a full example bringing everything together </p>

<pre>
# list of items to go in the menu
mylistofitems = []

# a call to a function that returns an array of objects you would create
# your menu from. for example a call to os.listdir to return a list of strings
# containing filenames
mylistofobjects = some_func_that_returns_you_list()

# loop through our object list and add each item to the list for the menu
for myobject in mylistofobjects:
    img_item = ImageItem(myobject, self)
    mylistofitems += [ img_item ]

# handle the no objects found case if we get an empty list
# this uses a single menu item
if (len(mylistofitems) == 0):
    mylistofitems += [menu.MenuItem(_('No Objects found'),
                      menuw.back_one_menu, 0)]

# create the menu using your menu list
myobjectmenu = menu.Menu(_('My Image Objects'), mylistofitems,
                         reload_func=menuw.back_one_menu )

# now we push our menu on the top of the stack and tell it to display
menuw.pushmenu(myobjectmenu)
menuw.refresh()
</pre>
<a id="bottom"></a>

</div>
<p id="pageinfo" class="info" lang="en" dir="ltr">last edited 2004-12-12 10:54:16 by <span title="134.102.71.53">Dischi</span>
<br>current version: <a href="http://freevo.sourceforge.net/cgi-bin/freevo-2.0/SourceDoc/MenuSystem">http://freevo.sourceforge.net/cgi-bin/freevo-2.0/SourceDoc/MenuSystem</a></p>
</div> <!-- end page -->
</body>
</html>
